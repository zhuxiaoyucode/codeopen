# CodeShare - 在线代码片段共享平台

## 项目概述

CodeShare 是一个轻量级在线代码片段分享工具，支持代码语法高亮、自定义过期时间与访问权限。用户可通过唯一链接快速分享代码片段，同时提供个人片段管理功能。

## 功能特性

### 公共功能（无需登录）
- ✅ 在线代码编辑与创建
- ✅ 多语言语法高亮（支持 JavaScript、Python、Java、Go 等）
- ✅ 过期时间设置（1天、1周、永久）
- ✅ 访问权限控制（公开/私密）
- ✅ 唯一链接生成与分享
- ✅ 代码片段查看与复制

### 用户中心功能（需登录）
- ✅ 用户注册与登录
- ✅ 个人片段管理
- ✅ 片段编辑与删除
- ✅ 分享链接管理

### 系统功能
- ✅ 片段自动存储与清理
- ✅ 链接有效性校验
- ✅ 安全性防护（XSS、SQL注入防护）

## 技术栈

### 前端
- **框架**: React 18 + TypeScript
- **路由**: React Router
- **状态管理**: Redux Toolkit
- **UI组件**: Ant Design
- **代码高亮**: Prism.js
- **构建工具**: Vite

### 后端
- **运行时**: Node.js + Express
- **数据库**: MongoDB
- **认证**: JWT
- **唯一ID生成**: nanoid

## 项目结构

```
codeshare/
├── frontend/                 # React前端应用
│   ├── src/
│   │   ├── components/       # 可复用组件
│   │   ├── pages/           # 页面组件
│   │   ├── store/           # Redux状态管理
│   │   ├── hooks/           # 自定义Hooks
│   │   ├── utils/           # 工具函数
│   │   └── types/           # TypeScript类型定义
│   ├── public/              # 静态资源
│   └── package.json
├── backend/                  # Node.js后端服务
│   ├── src/
│   │   ├── controllers/     # 控制器
│   │   ├── models/          # 数据模型
│   │   ├── routes/          # 路由定义
│   │   ├── middleware/      # 中间件
│   │   ├── utils/           # 工具函数
│   │   └── config/          # 配置文件
│   └── package.json
├── docs/                    # 项目文档
└── README.md
```

## 快速开始

### 环境要求
- Node.js >= 16.0.0
- MongoDB >= 4.4
- npm >= 8.0.0

### 安装与运行

1. **克隆项目**
```bash
git clone <repository-url>
cd codeshare
```

2. **安装依赖**
```bash
# 安装前端依赖
cd frontend
npm install

# 安装后端依赖  
cd ../backend
npm install
```

3. **环境配置**
在 `backend/.env` 文件中配置环境变量：
```env
MONGODB_URI=mongodb://localhost:27017/codeshare
JWT_SECRET=your-jwt-secret-key
PORT=3001
```

4. **启动服务**
```bash
# 启动后端服务（在backend目录）
npm run dev

# 启动前端服务（在frontend目录）  
npm run dev
```

5. **访问应用**
打开浏览器访问 http://localhost:3000

## 数据模型

### 用户表 (Users)
```typescript
interface User {
  _id: string;
  username: string;
  email: string;
  password: string; // 加密存储
  createdAt: Date;
}
```

### 代码片段表 (Snippets)
```typescript
interface Snippet {
  _id: string; // nanoid生成的短ID
  content: string;
  language: string;
  expiresAt: Date | null; // null表示永久有效
  isPrivate: boolean;
  creatorId: string | null; // null表示匿名用户创建
  createdAt: Date;
  title?: string; // 可选标题
}
```

## API接口

### 认证相关
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户退出

### 片段相关
- `POST /api/snippets` - 创建代码片段
- `GET /api/snippets/:id` - 获取片段详情
- `GET /api/snippets/user/:userId` - 获取用户片段列表
- `PUT /api/snippets/:id` - 更新片段
- `DELETE /api/snippets/:id` - 删除片段

## 开发指南

### 前端开发
- 使用函数组件和Hooks
- 遵循React最佳实践
- 实现响应式设计
- 使用TypeScript进行类型检查

### 后端开发
- 使用MVC架构模式
- 实现RESTful API设计
- 添加适当的错误处理
- 使用中间件进行认证和验证

## 部署说明

### 生产环境部署
1. 构建前端应用：`npm run build`
2. 配置生产环境变量
3. 使用PM2管理Node.js进程
4. 配置Nginx反向代理

### Docker部署
项目支持Docker容器化部署，具体配置参考 `docker-compose.yml` 文件。

## 贡献指南

欢迎提交Issue和Pull Request来改进项目！

## 许可证

MIT License